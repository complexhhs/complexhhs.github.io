---
layout: post
title: "[Bayesian method]EM_method"
author: "Hyunseok, Hwang"
categories: journal
tags: [documentation,sample]
---

인공지능이나 사람이나 어떤 주어진 데이터 $x$에 대해서 설명할때, 본래 가지고 사전지식 $\theta$이 데이터 분포 $P(x)$를 얼마나 잘 이해하는 정도가 성능의 지표가 된다. 이번 Bayesian method는 데이터를 분석하기 위한 사전지식을 추정하고 데이터 클러스터링에 적용가능한 **Expectation-Maximization method**, 줄여서 ***EM method***를 리뷰해보고자 한다.

### EM-method를 언제 사용하나?

적절한 예제를 생각해보니 [Cousera](https://www.coursera.org/learn/bayesian-methods-in-machine-learning) 강의에서 배운 예제가 적절하다 싶어 살짝만 바꿔서 설명하겠다.
금융회사에서 사람들에게 대출을 진행할때 작게는 몇 백, 크게는 수 십억 단위의 돈을 막퍼주는 것이 아니다. 금융회사는 금융회사 나름대로 대출을 희망하는 고객이 대출한 금액을 제때에 올바르게 상환 할 수 있는지 여부를 심사하는 프로세스가 있다. 신용불량자에서부터 1등급 신용점수 고객까지 나름대로의 금융과 관련된 정보를 가지고 대출 적격,부적격을 판별하는 과정을 최대한 현실세계에 맞도록 디자인 해보도록 하자.

|항목 | 자산규모 | 통장잔고 | 연령  | 거주지(급) | 3금융권 대출여부| 
|:---:|:---:|:---:|:---:|:---:|:---:| 
|고객1| 1억  | 500만원  | 31  | 2    | 없음 | 
|고객2| 5억  | -300만원 | None  | 3 | 없음 | 
|고객3| 3억  | None | 53  | 3    | 있음 |
|고객4| 30억 | 2000만원 | 76  | 1    | 없음 |

잔인하게도 보이겠지만 실제 금융권은 고객의 데이터를 이런식으로 테이블해서 일종의 점수로 대출적격 여부를 심사한다. 이제 가상으로 만든 4명의 고객들을 우리가 금융권 심사자라고 생각하고 대출적격 여부를 심사해보도록 하자. 
1번 고객의 경우 조그만 자산규모지만 적절한 거주지에 크게 대출사고를 일으킨것 없이 사회에 첫발을 들여놓은 30대 초의 사람이라고 어림짐작이 가능하다(현재 필자의 상황과 상당히 겹친다 ㅎㅎ). 2번 3번 고객의 경우부터 문제가 생긴다. 항목을보면 None값으로 데이터가 없는 케이스가 보인다. 심사자의 기준에서 데이터가 없거나 응답을 하지 않았을때 해당 항목들을 어떻게 평가할까? 2번 고객은 자산은 1번 고객보다 많지만 마.통을 열고 거주지도 더 좋지못한 상황에 처해있다고 상환능력이 얼마나될지 나이에 대한 정보만 없다고해서 뭐라고 판단하기가 애매하며, 3번고객은 통장잔고 값이 얼마인지는 모르지만 다른 3금융 대출여부가 있다고 상환능력을 얼마나 예상할지 문제가 된다. 마지막 고객은 굉장히 간단하다. 나이도 지긋이 있지만 그동안 살아오시면서 부를 착실히 모으신 (존경할만한) 어르신이라고 평가된다. 
자, 지금까지 우리는 주어진 데이터로 고객들과 각각의 데이터 항목들을 정성적으로 평가해서 어떤 사람인지 어림잡아서 평가를 진행했다. 그렇다면 이런 모습을 그림으로 그리면 다음과 같다.

![항목 거미줄 그림]()

이런 방식은 우리가 크게 생각하지 않아도 해당 항목들이 각각 어떻게 유기적으로 연결되는지 확인하며 생각하기에 편하지만 단점으로, 항목의 개수가 많아질수록 계산의 복잡도가 굉장히 커지며(1) 하나의 항목 정보가 없으면 평가하기 어렵다(2)는 부분을 지적하지 않을 수 없다. 

![항목 중앙집권 그림]()

그렇다면 이와 같이 하나의 변수로 금융관련 정보를 취합해서 "신용도"라는 잠재변수(Latent variable)을 만들어서 평가하면 어떨까? 해당 정보들을 모아서 하나의 잠재변수로 모으고 평가의 지표로 잠재변수를 이용하는 방식이다. 앞선 모든 항목을 사용한 분석방식과 비교하면 장점으로 분석할 변수가 현격히 줄어드는 점(1)과 보다 더 의미있는 
변수를 만들어 낼 수있는 점(2)이 있지만, 단점으로는 역시 이런 장점까지 이끌어내기까지의 과정이 생각보다 복잡하다는 부분을 지적해야한다.

시각화를 위해 위 테이블의 항목을 단 두개로 좁혀놓고 신용도를 보기위해 군집화(Clustering)을 시행해보자. 대략 총 자산규모와 통장잔고로 대략적인 사람들의 무리가 분류가 될것이다. 다음 군집화된 무리의 신용도 정도를 파악하면 대출 적격 여부가 어느정도 추산이 될 것이다. 신용도라는 잠재변수를 파악하기 위해 군집화를 시행하는 것이다.
